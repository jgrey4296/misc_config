SHELL=/usr/local/bin/bash
BASH_ENV=/Volumes/documents/github/emacs_files/setup_files/cron/conda_bashrc

### Hourly
0,30 */1 * * * cpu_check

### DAILY:
# Speak the time every 2 hours
0 */2 * * * conda activate bookmark; bkmk-bot-time

# Regularly Tweet an entry from my bibtex
7,42 */1 * * * conda activate bookmark; bkmk-bot-bibtex

# Regularly tweet an image from the whitelist
25,52 */1 * * * conda activate bookmark; bkmk-bot-image

# Update mail every 6 hours
0 */6 * * * /usr/local/bin/mbsync -a

# Regularly run tag grep
# 0 */1 * * * conda activate bookmark; bkmk-tag-grep -l /Volumes/documents/twitterthreads/ -t ~/github/writing/resources/cron_reports/totals.tags -o ~/github/writing/resources/cron_reports/grep_tags.index

# Regularly copy over pdfs and epubs, and stub them
0 */12 * * * dropbox_watcher

### WEEKLY:
## MON
# Run updates at 3am on mondays
0 3 * * mon run_maintenance

# Backup git repo urls
0 3 * * wed git_url_backup
# Backup list of installed brew packages
30 3 * * wed brew list > ~/.doom.d/setup_files/brew/installed

# backup cron definitions at 4am on mondays
0 4 * * mon crontab -l > ~/.doom.d/setup_files/cron/crontab.backup

## TUES
# at 4.30am on tuesdays, find any corrupted pdfs
30 4 * * tue find /Volumes/documents/MEGA/AutoSync/pdflibrary -name "*.pdf" -print0 | xargs -0 -I {} echo "pdftk {} dump_data_utf8 2>&1 1>/dev/null | awk '/Error/ { print \"{}: \" \$0}'" | bash > /Volumes/documents/github/writing/resources/cron_reports/pdf_verification

# at 2am on tuesdays, update bookmars
0 2 * * tue conda activate bookmark; bkmk-sql -n -t /Volumes/documents/github/writing/resources/bookmarks/total.bookmarks
## THUR
# 4am : clean bibtex
0 4 * * thu find ~/github/writing/resources/bibliography -name "*.bib" -print0 | xargs -0 -I {} echo "conda activate bookmark; bkmk-bib-clean -t {} -o {} " | bash
# 5am : clean tags
0 5 * * thu find ~/github/writing/resources/bibliography -name "*.bib" -print0 | xargs -0 -I {} echo "conda activate bookmark; bkmk-tag-clean -t {} -c ~/github/writing/resources/substitutions " | bash
# 6am : update tag totals
0 6 * * thu conda activate bookmark; bkmk-tag-totals -t ~/github/writing/resources/bibliography -t ~/github/writing/resources/bookmarks/total.bookmarks -t /volumes/documents/twitterthreads -c ~/github/writing/resources/substitutions -o ~/github/writing/resources/cron_reports/total.tags
# 7am : update tag graph
0 7 * * thu conda activate bookmark; bkmk-tag-graph --target ~/github/writing/resources/bibliography -t ~/github/writing/resources/bookmarks/total.bookmarks -t /volumes/documents/twitterthreads -o ~/github/writing/resources/cron_reports/tags.edgelist
# 8am : update tag timelines
0 8 * * thu conda activate bookmark; bkmk-bib-timeline --library ~/github/writing/resources/bibliography --output ~/github/writing/resources/tag_timelines

## FRI
# 5am : update tag index
0 5 * * fri conda activate bookmark; bkmk-tag-index --target /volumes/documents/twitterthreads --output ~/github/writing/resources/cron_reports/tw_tag.index
# 6am : update account index
0 6 * * fri conda activate bookmark; bkmk-twit-index --target /volumes/documents/twitterthreads --output ~/github/writing/resources/cron_reports/tw_acct.index
